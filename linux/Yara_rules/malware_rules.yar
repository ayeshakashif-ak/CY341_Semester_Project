rule MemoryResidentMalware
{
    meta:
        description = "Detects in-memory-only malware via known patterns"
        author = "Ayesha"
        date = "2025-05-08"

    strings:
        $api1 = "VirtualAlloc" ascii
        $api2 = "VirtualProtect" ascii
        $api3 = "CreateRemoteThread" ascii
        $hex1 = { 6A 00 68 ?? ?? ?? ?? 64 A1 00 00 00 00 50 }

    condition:
        2 of ($api*) or $hex1
}
